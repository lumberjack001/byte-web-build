(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9352],{42050:function(e,l,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/tools/record/edit/sales/[recordId]",function(){return n(2064)}])},94983:function(e,l,n){"use strict";var t=n(85893),a=n(78022),s=function(e){var l=e.heightTailwind,n=e.spinnerColor;return(0,t.jsx)("div",{className:"w-full ".concat(void 0===l?"h-[50vh]":l," flex items-center justify-center"),children:(0,t.jsx)(a.s5,{strokeColor:void 0===n?"#4E5AA5":n,strokeWidth:"4",animationDuration:"0.75",width:"40",visible:!0})})};l.Z=s},2064:function(e,l,n){"use strict";n.r(l);var t=n(14924),a=n(26042),s=n(99534),r=n(70603),i=n(85893),o=n(82580),d=n(9008),c=n.n(d),u=n(11163),m=n(67294),h=n(91444),p=n(16310),x=n(70757),f=n(74975),v=n(22606),j=n(32662),g=n(93890),y=n(90583),b=n(63240),w=n(20823),N=n(82545),Z=n(94983),_=n(62523),q=n(62339),B=n(79405),C=function(){var e,l,n,d=(0,m.useState)(null),x=d[0],f=d[1],C=(0,m.useState)(!1),R=C[0],E=C[1],A=(0,u.useRouter)().query.recordId,D=(0,B.mX)(A,{refetchOnMountOrArgChange:!0}),M=D.data,S=D.isLoading,k=D.isSuccess,T=(0,r.Z)((0,B.jZ)(),2),F=T[0],P=T[1].isLoading;return(0,m.useEffect)(function(){if(k&&!(0,q.x)(null==M?void 0:M.data)&&(null==M?void 0:M.data)!==null){var e=null==M?void 0:M.data;f(e),E(!(0,q.x)(e.services))}},[k,M]),(0,i.jsxs)("div",{children:[(0,i.jsxs)(c(),{children:[(0,i.jsx)("title",{children:"Edit sales record - Byte"}),(0,i.jsx)("meta",{name:"viewport",content:"initial-scale=1.0, width=device-width"})]}),(0,i.jsx)("div",{className:"h-full w-full flex items-center justify-center",children:S?(0,i.jsx)(Z.Z,{heightTailwind:"h-[70vh]"}):(0,q.x)(x)||null==x?(0,i.jsx)("div",{className:"w-full h-[70vh] flex items-center justify-center text-gray-400",children:"No data! Please refresh"}):(0,i.jsx)(o.J9,{enableReinitialize:!0,initialValues:(0,t.Z)({customer:x.customer,description:x.description,type:x.type,dealType:x.dealType,paymentMethod:x.paymentMethod,date:x.date,totalAmount:x.totalAmount},R?"services":"products",R?null==x?void 0:null===(e=x.services)||void 0===e?void 0:e.map(function(e){return e._id,(0,s.Z)(e,["_id"])}):null==x?void 0:null===(l=x.products)||void 0===l?void 0:l.map(function(e){return e._id,(0,s.Z)(e,["_id"])})),onSubmit:function(e){var l=e.description,n=(0,s.Z)(e,["description"]);console.log(l);var t=(0,a.Z)({},n,e.description&&void 0!==e.description&&{description:e.description});F({recordId:"".concat(A),data:t}).unwrap().then(function(){h.Am.success("Record updated successfully!")}).catch(function(e){var l;h.Am.error((null==e?void 0:null===(l=e.data)||void 0===l?void 0:l.message)||"Couldn't update record")})},validationSchema:p.Ry().shape((n={paymentMethod:p.Z_().required("Required"),description:p.Z_().nullable().notRequired().when("description",{is:function(e){return null==e?void 0:e.length},then:function(e){return e.min(3)}}),date:p.hT().required("Required")},(0,t.Z)(n,R?"services":"products",R?p.IX().of(p.Ry().shape({name:p.Z_().required("Required"),cost:p.Rx().min(5,"can't be less than ₦5").required("Required")})):p.IX().of(p.Ry().shape({name:p.Z_().required("Required"),quantity:p.Rx().min(1,"can't be less than 1").required("Required"),unitPrice:p.Rx().min(5,"can't be less than ₦5").required("Required")}))),(0,t.Z)(n,"customer",p.Ry().shape({name:p.Z_().required("Required"),phone:p.Z_().matches(/^[0-9]+$/,"Must be only digits").required("Required")})),n),[["description","description"]]),children:function(e){var l,n,t,a,s,r,d,c,u=e.values,m=e.touched,h=e.errors,p=e.handleChange,x=e.handleBlur,f=e.handleSubmit,Z=e.setFieldValue,q=e.dirty;return(0,i.jsxs)(o.l0,{onSubmit:function(e){return e.preventDefault()},className:"flex flex-col w-full h-full gap-6",children:[(0,i.jsx)("div",{className:"w-full flex-col flex gap-6",children:R?(0,i.jsx)(o.F2,{name:"services",render:function(e){var l=e.push,n=e.remove;return(0,i.jsx)(j.Z,{values:u,push:l,remove:n,handleChange:p,handleBlur:x,setFieldValue:Z})}}):(0,i.jsx)(o.F2,{name:"products",render:function(e){var l=e.push,n=e.remove,t=e.replace;return(0,i.jsx)(i.Fragment,{children:(null==u?void 0:u.products)!==void 0&&(null==u?void 0:u.products).map(function(e,a){return(0,i.jsx)(v.Z,{product:e,productIndex:a,values:u,push:l,replace:t,remove:n,handleChange:p,handleBlur:x,setFieldValue:Z},a)})})}})}),(0,i.jsxs)("div",{className:"w-full flex gap-6",children:[(0,i.jsxs)("div",{className:"flex w-[40%] flex-col border p-4 border-[#E6EAED] rounded-2xl gap-4 h-fit",children:[(0,i.jsx)("p",{className:"w-full p-4 border-b border-[#D0D6DB] text-sm text-[#5864AE]",children:"Customer Details"}),(0,i.jsxs)("div",{className:"flex flex-col w-full gap-4",children:[(0,i.jsxs)("label",{className:"w-full flex flex-col gap-2",children:[(0,i.jsx)("span",{className:"text-sm text-[#30333B] font-normal",children:"Customer name"}),(0,i.jsx)(w.Z,{name:"customer.name",onChange:p,onBlur:x,value:null===(l=u.customer)||void 0===l?void 0:l.name,placeholder:"Enter customer name",type:"text"}),(null===(n=m.customer)||void 0===n?void 0:n.name)&&(null===(t=h.customer)||void 0===t?void 0:t.name)&&(0,i.jsx)(b.Z,{message:(null===(a=h.customer)||void 0===a?void 0:a.name)||""})]}),(0,i.jsxs)("label",{className:"w-full flex flex-col gap-2",children:[(0,i.jsx)("span",{className:"text-sm text-[#30333B] font-normal",children:"Phone number"}),(0,i.jsx)(N.Z,{name:"customer.phone",onChange:p,onBlur:x,value:null===(s=u.customer)||void 0===s?void 0:s.phone,placeholder:"phone",type:"phone"}),(null===(r=m.customer)||void 0===r?void 0:r.phone)&&(null===(d=h.customer)||void 0===d?void 0:d.phone)&&(0,i.jsx)(b.Z,{message:(null===(c=h.customer)||void 0===c?void 0:c.phone)||""})]})]})]}),(0,i.jsxs)("div",{className:"flex w-full h-fit flex-col border p-4 border-[#E6EAED] rounded-2xl gap-4",children:[(0,i.jsx)("p",{className:"w-full p-4 border-b border-[#D0D6DB] text-sm text-[#5864AE]",children:"Other information"}),(0,i.jsxs)("div",{className:"w-full flex gap-4",children:[(0,i.jsxs)("div",{className:"flex flex-col w-full gap-3",children:[u.description?(0,i.jsxs)("label",{className:"w-full flex flex-col gap-2",children:[(0,i.jsx)("span",{className:"text-sm text-[#30333B] font-normal",children:"Description"}),(0,i.jsx)(_.Z,{rows:5,name:"description",onChange:p,onBlur:x,value:u.description,placeholder:"Enter description"}),m.description&&h.description&&(0,i.jsx)(b.Z,{message:h.description||""})]}):null,(0,i.jsxs)("label",{className:"w-full flex flex-col gap-3",children:[(0,i.jsx)("span",{className:"text-sm text-[#30333B] font-normal",children:"Payment method"}),(0,i.jsxs)("div",{role:"group","aria-labelledby":"payment-method-group",className:"flex gap-4",children:[(0,i.jsx)(y.Z,{checked:"cash"===u.paymentMethod,type:"radio",name:"paymentMethod",onChange:p,onBlur:x,value:"cash",label:"Cash",className:"mb-md-1"}),(0,i.jsx)(y.Z,{checked:"pos"===u.paymentMethod,type:"radio",name:"paymentMethod",onChange:p,onBlur:x,value:"pos",label:"POS",className:"mb-md-1"}),(0,i.jsx)(y.Z,{checked:"transfer"===u.paymentMethod,type:"radio",name:"paymentMethod",onChange:p,onBlur:x,value:"transfer",label:"Transfer"})]}),m.paymentMethod&&h.paymentMethod&&(0,i.jsx)(b.Z,{message:h.paymentMethod||""})]})]}),(0,i.jsxs)("label",{className:"w-full flex flex-col gap-2",children:[(0,i.jsx)("span",{className:"text-sm text-[#30333B] font-normal",children:"Date"}),(0,i.jsx)(w.Z,{name:"date",onChange:p,onBlur:x,value:new Date(u.date).toLocaleDateString("en-CA")||"2022-01-01",placeholder:"Date",type:"date"}),m.date&&h.date&&(0,i.jsx)(b.Z,{message:h.date||""})]})]})]})]}),(0,i.jsxs)("div",{className:"flex flex-col w-full items-start gap-6 pb-6",children:[(0,i.jsxs)("div",{className:"flex justify-between py-4 px-6 bg-[#F8F9FA] rounded-2xl w-full",children:[(0,i.jsx)("p",{className:"text-[#808691] text-base font-normal",children:"Total Amount"}),(0,i.jsx)("p",{className:"text-[#19A97B] text-xl font-normal",children:"₦".concat(u.totalAmount.toLocaleString("en-US"))})]}),(0,i.jsx)(g.Z,{loading:P,disabled:!q||P,click:f,title:"Save changes",type:"large",color:"btnPrimary"})]})]})}})})]})};C.getLayout=function(e){return(0,i.jsx)(f.Z,{children:(0,i.jsx)(x.Z,{enableBackBtn:!0,headerTitle:"Edit sales record",children:e})})},l.default=C}},function(e){e.O(0,[9429,6735,7700,7279,7156,2235,1843,2193,9774,2888,179],function(){return e(e.s=42050)}),_N_E=e.O()}]);