(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1072],{12477:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/tools/invoices/edit-invoice/[invoiceId]",function(){return n(10178)}])},94983:function(e,t,n){"use strict";var a=n(85893),s=n(78022),l=function(e){var t=e.heightTailwind,n=e.spinnerColor;return(0,a.jsx)("div",{className:"w-full ".concat(void 0===t?"h-[50vh]":t," flex items-center justify-center"),children:(0,a.jsx)(s.s5,{strokeColor:void 0===n?"#4E5AA5":n,strokeWidth:"4",animationDuration:"0.75",width:"40",visible:!0})})};t.Z=l},10178:function(e,t,n){"use strict";n.r(t);var a=n(14924),s=n(99534),l=n(70603),i=n(85893),r=n(82580),o=n(9008),u=n.n(o),c=n(11163),d=n(67294),m=n(91444),h=n(16310),x=n(47883),f=n(5042),p=n(33513),v=n(70757),g=n(74975),j=n(93890),b=n(90583),y=n(63240),Z=n(20823),w=n(82545),D=n(94983),N=n(76984),P=n(62291),q=n(10904),A=n(62339),C=n(79405),R=function(){var e,t,n=(0,d.useState)({type:"",paymentMethod:"",discountPercentage:0,_id:"",issuedDate:"2011-12-31T23:00:00.000Z",dueDate:"2011-12-31T23:00:00.000Z",createdAt:"",updatedAt:"",accountID:0,status:"",business:"",num:"",products:[{name:"",quantity:0,unitPrice:0,taxPercentage:0},],services:[{name:"",cost:0,taxPercentage:0},],subTotal:0,taxAmount:0,discountAmount:0,totalAmount:0,customer:{name:"",phone:""}}),o=n[0],v=n[1],g=(0,d.useState)(!1),R=g[0],B=g[1],E=(0,d.useState)(!1),_=E[0],S=E[1],T=(0,d.useState)(!1),k=T[0],O=T[1],M=(0,d.useState)(!1),I=M[0],F=M[1],L=(0,c.useRouter)(),V=L.query.invoiceId,X=function(){F(!0),setTimeout(function(){F(!1),L.replace("/dashboard/tools/invoices")},5e3)},Y=(0,C.Ld)(V,{refetchOnMountOrArgChange:!0}),z=Y.data,J=Y.isLoading,W=Y.isSuccess,$=(0,l.Z)((0,C.Sy)(),2),G=$[0],H=$[1].isLoading;return(0,d.useEffect)(function(){W&&!(0,A.x)(null==z?void 0:z.data)&&(null==z?void 0:z.data)!==null&&(v(null==z?void 0:z.data),B((null==z?void 0:z.data.type)==="service"))},[W,z]),(0,i.jsxs)("div",{children:[(0,i.jsxs)(u(),{children:[(0,i.jsx)("title",{children:"Edit invoice - Byte"}),(0,i.jsx)("meta",{name:"viewport",content:"initial-scale=1.0, width=device-width"})]}),(0,i.jsx)("div",{className:"h-full w-full flex items-center justify-center",children:J?(0,i.jsx)(D.Z,{heightTailwind:"h-[70vh]"}):(0,A.x)(o)||null==o?(0,i.jsx)("div",{className:"w-full h-[70vh] flex items-center justify-center text-gray-400",children:"No data! Please refresh"}):(0,i.jsx)(r.J9,{enableReinitialize:!0,initialValues:(e={type:o.type,paymentMethod:o.paymentMethod,discountPercentage:o.discountPercentage,issuedDate:new Date(o.issuedDate).toLocaleDateString("en-CA"),dueDate:new Date(o.dueDate).toLocaleDateString("en-CA")},(0,a.Z)(e,R?"services":"products",R?o.services.map(function(e){return e._id,(0,s.Z)(e,["_id"])}):o.products.map(function(e){return e._id,(0,s.Z)(e,["_id"])})),(0,a.Z)(e,"subTotal",o.subTotal),(0,a.Z)(e,"taxAmount",o.taxAmount),(0,a.Z)(e,"discountAmount",o.discountAmount),(0,a.Z)(e,"totalAmount",o.totalAmount),(0,a.Z)(e,"customer",o.customer),e),onSubmit:function(e){G({invoiceId:"".concat(V),data:e}).unwrap().then(function(){O(!1),X()}).catch(function(e){var t;m.Am.error((null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.message)||"Couldn't update invoice")})},validationSchema:h.Ry((t={paymentMethod:h.Z_().required("Required"),discountPercentage:h.Rx(),issuedDate:h.hT().required("Required"),dueDate:h.hT().required("Required")},(0,a.Z)(t,R?"services":"products",R?h.IX().of(h.Ry().shape({name:h.Z_().required("Required"),cost:h.Rx().min(5,"can't be less than ₦5").required("Required"),taxPercentage:h.Rx().required("Required")})):h.IX().of(h.Ry().shape({taxPercentage:h.Rx().required("Required"),name:h.Z_().required("Required"),quantity:h.Rx().min(1,"can't be less than 1").required("Required"),unitPrice:h.Rx().min(5,"can't be less than ₦5").required("Required")}))),(0,a.Z)(t,"customer",h.Ry().shape({name:h.Z_().required("Required"),phone:h.Z_().matches(/^[0-9]+$/,"Must be only digits").required("Required")})),t)),children:function(e){var t,n,a,s,l,o,u,c,d=e.values,m=e.touched,h=e.errors,v=e.handleChange,g=e.handleBlur,D=e.handleSubmit,A=e.setFieldValue,C=e.dirty,B=e.isValid;return(0,i.jsxs)(i.Fragment,{children:[I&&(0,i.jsx)(P.Z,{children:(0,i.jsx)(N.Z,{title:"You’ve generated your invoice!",message:"Congratulations! Your invoice has been successfully generated. Tap the share button below to share it to your customer.",buttonTitle:"Done",buttonOnClick:function(){return F(!1)}})}),k&&(0,i.jsx)(p.Z,{handleSubmit:D,isLoading:H,dirty:C,isValid:B,values:d,isService:R,onClose:function(){return O(!1)}}),(0,i.jsxs)(r.l0,{onSubmit:function(e){return e.preventDefault()},className:"flex flex-col w-full h-full gap-6",children:[(0,i.jsx)("div",{className:"w-full flex-col flex gap-6",children:R?(0,i.jsx)(r.F2,{name:"services",render:function(e){var t=e.push,n=e.remove;return(0,i.jsx)(f.Z,{values:d,push:t,remove:n,handleChange:v,handleBlur:g,setFieldValue:A})}}):(0,i.jsx)(r.F2,{name:"products",render:function(e){var t=e.push,n=e.remove,a=e.replace;return(0,i.jsx)(i.Fragment,{children:(null==d?void 0:d.products)!==void 0&&(null==d?void 0:d.products).map(function(e,s){return(0,i.jsx)(x.Z,{product:e,productIndex:s,values:d,push:t,replace:a,remove:n,handleChange:v,handleBlur:g,setFieldValue:A},s)})})}})}),(0,i.jsxs)("div",{className:"w-full flex gap-6",children:[(0,i.jsxs)("div",{className:"flex w-[40%] flex-col border p-4 border-[#E6EAED] rounded-2xl gap-4 h-fit",children:[(0,i.jsx)("p",{className:"w-full p-4 border-b border-[#D0D6DB] text-sm text-[#5864AE]",children:"Customer Details"}),(0,i.jsxs)("div",{className:"flex flex-col w-full gap-4",children:[(0,i.jsxs)("label",{className:"w-full flex flex-col gap-2",children:[(0,i.jsx)("span",{className:"text-sm text-[#30333B] font-normal",children:"Customer name"}),(0,i.jsx)(Z.Z,{name:"customer.name",onChange:v,onBlur:g,value:null===(t=d.customer)||void 0===t?void 0:t.name,placeholder:"Enter customer name",type:"text"}),(null===(n=m.customer)||void 0===n?void 0:n.name)&&(null===(a=h.customer)||void 0===a?void 0:a.name)&&(0,i.jsx)(y.Z,{message:(null===(s=h.customer)||void 0===s?void 0:s.name)||""})]}),(0,i.jsxs)("label",{className:"w-full flex flex-col gap-2",children:[(0,i.jsx)("span",{className:"text-sm text-[#30333B] font-normal",children:"Phone number"}),(0,i.jsx)(w.Z,{name:"customer.phone",onChange:v,onBlur:g,value:null===(l=d.customer)||void 0===l?void 0:l.phone,placeholder:"phone",type:"phone"}),(null===(o=m.customer)||void 0===o?void 0:o.phone)&&(null===(u=h.customer)||void 0===u?void 0:u.phone)&&(0,i.jsx)(y.Z,{message:(null===(c=h.customer)||void 0===c?void 0:c.phone)||""})]})]})]}),(0,i.jsxs)("div",{className:"flex w-[60%] h-fit flex-col border p-4 border-[#E6EAED] rounded-2xl gap-4",children:[(0,i.jsx)("p",{className:"w-full p-4 border-b border-[#D0D6DB] text-sm text-[#5864AE]",children:"Other Information"}),(0,i.jsxs)("div",{className:"w-full flex gap-4",children:[(0,i.jsxs)("div",{className:"flex flex-col w-full gap-4",children:[(0,i.jsxs)("label",{className:"w-full flex flex-col gap-2",children:[(0,i.jsx)("span",{className:"text-sm text-[#30333B] font-normal",children:"Date issued"}),(0,i.jsx)(Z.Z,{name:"issuedDate",onChange:v,onBlur:g,value:new Date(d.issuedDate).toLocaleDateString("en-CA"),placeholder:"Date issued",type:"date"}),m.issuedDate&&h.issuedDate&&(0,i.jsx)(y.Z,{message:h.issuedDate||""})]}),(0,i.jsxs)("label",{className:"w-full flex flex-col gap-2",children:[(0,i.jsx)("span",{className:"text-sm text-[#30333B] font-normal",children:"Payment method"}),(0,i.jsxs)("div",{role:"group","aria-labelledby":"payment-method-group",className:"flex flex-col gap-2",children:[(0,i.jsx)(b.Z,{checked:"online"===d.paymentMethod,type:"radio",name:"paymentMethod",onChange:v,onBlur:g,value:"online",label:"Online payment",className:"mb-md-1"}),(0,i.jsx)(b.Z,{checked:"transfer"===d.paymentMethod,type:"radio",name:"paymentMethod",onChange:v,onBlur:g,value:"transfer",label:"Bank transfer",className:"mb-md-1"}),(0,i.jsx)(b.Z,{checked:_,type:"checkbox",onChange:function(){_&&A("discountPercentage",0),S(!_)},onBlur:g,value:"discount",label:"Apply discount"})]}),m.paymentMethod&&h.paymentMethod&&(0,i.jsx)(y.Z,{message:h.paymentMethod||""})]})]}),(0,i.jsxs)("div",{className:"flex flex-col w-full gap-4",children:[(0,i.jsxs)("label",{className:"w-full flex flex-col gap-2",children:[(0,i.jsx)("span",{className:"text-sm text-[#30333B] font-normal",children:"Expiry date"}),(0,i.jsx)(Z.Z,{name:"dueDate",onChange:v,onBlur:g,value:d.dueDate,placeholder:"Expired date",type:"date"}),m.dueDate&&h.dueDate&&(0,i.jsx)(y.Z,{message:h.dueDate||""})]}),_?(0,i.jsxs)("label",{className:"w-full flex flex-col gap-2",children:[(0,i.jsx)("span",{className:"text-sm text-[#30333B] font-normal",children:"Discount percentage"}),(0,i.jsx)(Z.Z,{name:"discountPercentage",onChange:v,onBlur:g,value:d.discountPercentage,placeholder:"Enter discount percentage",type:"number"}),m.discountPercentage&&h.discountPercentage&&(0,i.jsx)(y.Z,{message:h.discountPercentage||""})]}):null]})]})]})]}),(0,i.jsxs)("div",{className:"flex flex-col items-start gap-6 pb-6",children:[(0,i.jsx)("div",{className:"flex flex-col items-stretch w-full",children:(0,i.jsx)(q.Z,{setFields:A?function(e,t){A("discountAmount",t),A("totalAmount",e)}:void 0,subTotal:d.subTotal,taxAmount:d.taxAmount,discountPercentage:d.discountPercentage,value:" "})}),(0,i.jsx)(j.Z,{disabled:!C||H||!B,click:function(){return O(!0)},title:"Preview Invoice",iconPosition:"right",icon:"invoice",type:"large",color:"btnPrimary"})]})]})]})}})})]})};R.getLayout=function(e){return(0,i.jsx)(g.Z,{children:(0,i.jsx)(v.Z,{enableBackBtn:!0,headerTitle:"Edit invoice",children:e})})},t.default=R},99534:function(e,t,n){"use strict";function a(e,t){if(null==e)return{};var n,a,s=function(e,t){if(null==e)return{};var n,a,s={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}n.d(t,{Z:function(){return a}})}},function(e){e.O(0,[9429,6735,7700,7279,7156,2235,1843,1619,9774,2888,179],function(){return e(e.s=12477)}),_N_E=e.O()}]);